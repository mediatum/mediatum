<!--
  Copyright (C) since 2007, Technical University of Munich (TUM) and mediaTUM authors
  SPDX-License-Identifier: AGPL-3.0-or-later
-->
<p metal:define-macro="filetype_error" style="color:red" i18n:translate="edit_files_filetype_error">
    TEXT
</p>

<tal:block metal:define-macro="edit_files_file">
    <script src="/static/js/jquery.layout.resizePaneAccordions-latest.min.js"> </script>
    <script src="/static/js/edit/modules/files1.js"> </script>

    <div id="navigation_content" class="mediatum_navigation_content"> </div>

    <div id="sub_content_content" class="mediatum_sub_content_content">

    <tal:block tal:condition="python:update_error">
        <p class="error" i18n:translate="file_processingerror">TEXT</p>
    </tal:block>

    <tal:block tal:condition="python:update_error_extension">
        <p class="error" i18n:translate="file_extensionerror">TEXT</p>
    </tal:block>

        <div id="accordion">
            <!-- file upload -->
            <h3><a href="#!" i18n:translate="edit_files_options" class="mediatum-link-mediatum"> </a></h3>
            <div class="mediatum_files_options">
                <form method="post" enctype="multipart/form-data">
                    <input tal:attributes="value csrf" type="hidden" name="csrf_token"/>
                    <input tal:attributes="value srcnodeid" type="hidden" name="srcnodeid"/>
                            <b><tal:block i18n:translate="edit_files_change"/>:</b>
                            <p>
                                <tal:block tal:condition="python:node.has_upload_file">
                                    <input class="mediatum_white_border" type="radio" name="change_file" value="yes" checked="checked" onclick="setInput('')"/>
                                <tal:block i18n:translate="edit_files_change"/>
                                </tal:block>
                                <tal:block tal:condition="python:not node.has_upload_file">
                                    <input class="mediatum_white_border" type="radio" name="change_file" value="no" checked="checked" onclick="setInput('')"/>
                                <tal:block i18n:translate="edit_files_add_obj"/>
                                </tal:block>
                                <br/>
                                <input type="radio" name="change_file" value="attfile" onclick="setInput('')" class="mediatum_white_border"/>
                                <tal:block i18n:translate="edit_files_add_attfile"/>
                                <br/>
                                <input type="radio" name="change_file" value="addthumb" onclick="setInput('')" class="mediatum_white_border"/>
                                <tal:block i18n:translate="edit_files_addthumbnail"/>
                                <br/>
                            </p>

                            <span id="inputname" style="display:none"><tal:block i18n:translate="edit_files_dirname"/>
                                <input type="text" name="inputname" size="60"/></span>
                            <br/>
                            <span id="updatefile"><tal:block i18n:translate="edit_files_choosefile"/> <input name="updatefile"  type="file" size="50"/></span>
                            <p>
                                <button i18n:attributes="title edit_upload_upload_label" i18n:translate="edit_upload_upload_label" type="submit"
                                name="addfile" value="submit">TEXT</button>
                            </p>
                            <input type="hidden" name="operation" value="change"/>
                        </form>
                </div>

            <!-- file list -->
            <h3><a href="#!" i18n:translate="edit_files_files" class="mediatum-link-mediatum"> </a></h3>
            <div id="files">
                <form method="post">
                    <input tal:attributes="value csrf" type="hidden" name="csrf_token"/>
                    <input tal:attributes="value srcnodeid" type="hidden" name="srcnodeid"/>
                    <table class="mediatum_filetable_files" cellpadding="0px" cellspacing="0px">
                        <tr>
                            <th i18n:translate="edit_files_location">TEXT</th>
                            <th i18n:translate="type" class="mediatum_filetable_files_th_size50"> </th>
                            <th i18n:translate="size" class="mediatum_filetable_files_th_size50 mediatum_filetable_files_th_ralign"> </th>
                            <th i18n:translate="mimetype" class="mediatum_filetable_files_th_size50"> </th>
                            <th class="mediatum_filetable_files_th_ralign mediatum_filetable_files_th_size25" > </th>
                         </tr>

                        <tr tal:repeat="file python:files">
                            <tal:block tal:condition="python:file.type!='attachment' and (user.isAdmin() or file.type!='statistic')">
                            <td>
                                <a
                                    tal:attributes="href python:u'/file/{}/{}'.format(node.id, file.getName())"
                                    tal:content="python:file.path"
                                    i18n:attributes="title edit_files_open_title"
                                    target="filewindow"
                                    class="mediatum-link-mediatum"
                                />
                            </td>
                            <td tal:content="python:file.type"/>
                            <td tal:content="python:file.getSize()" class="mediatum_filetable_files_th_ralign" />
                            <td tal:content="python:file.mimetype"/>
                            <td class="mediatum_filetable_files_th_ralign mediatum_filetable_files_th_size30" >
                                <input
                                    tal:attributes="name python:u'del|{}|{}'.format(file.type, file.getName())"
                                    type="image"
                                    src="/static/img/editor/mediatum_delete_black.svg"
                                    onclick="return questionDelName('')"
                                />&nbsp;
                            </td>
                            </tal:block>
                        </tr>
                    </table>
                    <input type="hidden" name="operation" value="delete"/>
                </form>
            </div>

            <!-- attachments -->
            <tal:block tal:condition="python:len(attfiles)>0">
                <h3><a href="#!"  i18n:translate="edit_files_attachments" class="mediatum-link-mediatum"> </a></h3>
                <div id="attfiles">
                    <form method="post">
                        <input tal:attributes="value csrf" type="hidden" name="csrf_token">
                        <input tal:attributes="value srcnodeid" type="hidden" name="srcnodeid">
                            <table class="mediatum_filetable_files" cellpadding="0px" cellspacing="0px">
                                <tr>
                                    <th i18n:translate="type"> </th>
                                    <th i18n:translate="size"> </th>
                                    <th i18n:translate="mimetype"> </th>
                                    <th i18n:translate="edit_files_location">TEXT</th>
                                    <th i18n:translate="edit_files_options">TEXT</th>
                                </tr>
                                <tr tal:repeat="file attfiles">
                                    <td tal:content="python:file.type"/>
                                    <td tal:content="python:file.getSize()"/>
                                    <td tal:content="python:file.mimetype"/>
                                    <td>
                                        <a
                                            tal:condition="python:file.getSize()>0"
                                            tal:attributes="href python:u'/file/{}/{}'.format(node.id, file.getName())"
                                            tal:content="python:file.getName()"
                                            i18n:attributes="title edit_files_open_title"
                                            target="filewindow"
                                            class="mediatum-link-mediatum"
                                        />
                                        <b tal:condition="python:file.getSize()==0" tal:content="python:file.getName()"/>
                                    </td>
                                    <td class="mediatum_files_ta_center">
                                        <input
                                            tal:condition="python:file.type not in ['original', 'image']"
                                            tal:attributes="name python:u'del|{}|{}'.format(file.type, file.getName())"
                                            type="image"
                                            src="/static/img/delete.png"
                                            onclick="return questionDelName('')"
                                        />&nbsp;
                                    </td>
                                </tr>
                                <tr tal:repeat="file att">
                                    <td tal:content="python:u' - {}'.format(file.filetype)"/>
                                    <td tal:content="python:file.getSize()"/>
                                    <td tal:content="python:file.mimetype"/>
                                    <td>
                                        <a
                                            tal:condition="python:file.getSize()>0"
                                            tal:attributes="href python:u'/attfile/{}/{}'.format(node.id, file._path)"
                                            tal:content="python:file.getName()"
                                            i18n:attributes="title edit_files_open_title"
                                            target="filewindow"
                                            class="mediatum-link-mediatum"
                                        />
                                        <b tal:condition="python:file.getSize()==0" tal:content="python:file.getName()"/>
                                    </td>
                                    <td class="mediatum_files_ta_center">
                                        <input
                                            tal:condition="python:file.type not in ['original', 'image']"
                                            tal:attributes="name python:u'delatt|{}|{}'.format(file.type, file.getName())"
                                            type="image"
                                            src="/static/img/delete.png"
                                            onclick="return questionDelName('')"
                                        />&nbsp;
                                    </td>
                                </tr>
                            </table>
                            <input type="hidden" name="operation" value="delete"/>
                        </form>
                </div>
            </tal:block>

            <!-- statistics -->
            <tal:block tal:condition="python:len(statfiles)>0">
                <h3><a href="#!" i18n:translate="edit_files_stats" class="mediatum-link-mediatum"> </a></h3>
                <div id="statfiles">
                    <form method="post">
                        <input tal:attributes="value csrf" type="hidden" name="csrf_token">
                        <input tal:attributes="value srcnodeid" type="hidden" name="srcnodeid">
                            <table class="mediatum_filetable_files" cellpadding="0px" cellspacing="0px">
                                <tr>
                                    <th i18n:translate="type"> </th>
                                    <th i18n:translate="size"> </th>
                                    <th i18n:translate="mimetype"> </th>
                                    <th i18n:translate="edit_files_location">TEXT</th>
                                    <th i18n:translate="edit_files_options">TEXT</th>
                                </tr>
                                <tr tal:repeat="file statfiles">
                                    <td tal:content="python:file.type"/>
                                    <td tal:content="python:file.getSize()"/>
                                    <td tal:content="python:file.mimetype"/>
                                    <td>
                                        <a
                                            tal:attributes="href python:u'/file/{}/{}'.format(node.id, file.getName())"
                                            tal:content="python:file.getName()"
                                            i18n:attributes="title edit_files_open_title"
                                            target="filewindow"
                                            class="mediatum-link-mediatum"
                                        />
                                    </td>
                                    <td class="mediatum_files_ta_center">
                                        <input
                                            tal:condition="python:file.type not in ['original', 'image']"
                                            tal:attributes="name python:u'del|{}|{}'.format(file.type, file.getName())"
                                            type="image"
                                            src="/static/img/delete.png"
                                            onclick="return questionDelName('')"
                                        />&nbsp;
                                    </td>
                                </tr>
                            </table>
                            <input type="hidden" name="operation" value="delete"/>
                        </form>
                </div>
            </tal:block>

            <!-- child elements -->
            <tal:block tal:condition="python:not node.isContainer()">
                <h3><a href="#!" i18n:translate="edit_files_children" class="mediatum-link-mediatum"> </a></h3>
                <div id="children" class="mediatum_padding10">
                    <h2>Kindelemente</h2>
                            <b i18n:translate="edit_files_childobjects">TEXT</b><br/>
                            <a
                                tal:attributes="onclick python:u'openWindow(\'/edit/edit_content?srcnodeid={}&id={}&tab=files&style=popup&parent=\'+parent.tree.currentfolder)'.format(srcnodeid, node.id)"
                                target="_blank"
                                i18n:attributes="title edit_files_add_title"
                                style="cursor:pointer">
                                <div class="mediatum_edit_files_childobjects">
                                    <div class="mediatum_edit_files_childobjects_plus">+</div>
                                </div>
                            </a>
                            <div id="childnodes" class="mediatum_childnodes">
                                <div id="sortable" class="connectedSortable">
                                    <div tal:repeat="child python:node.getChildren().sort_by_name()" class="mediatum_sortable_default"
                                    tal:attributes="id python:child.id">
                                        <img tal:attributes="id python:child.id; src python:u'/thumbnail/{}'.format(child.id)"/>
                                        <div class="mediatum_edit_files_edit_child">
                                            <a
                                                tal:attributes="href python:u'/edit/edit_content?srcnodeid={}&id={}&tab=metadata'.format(srcnodeid, child.id)"
                                                i18n:attributes="title edit_files_edit_child"
                                            >
                                                <img src="/static/img/edit.png"/>
                                            </a>
                                            <a
                                                href="#"
                                                tal:attributes="onclick python:u'return removeItem(this.id, {})'.format(node.id);id python:child.id"
                                                i18n:attributes="title edit_files_delete_child"
                                            >
                                                <img src="/static/img/delete.png"/>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <p><tal:block i18n:translate="edit_files_order_label">TEXT</tal:block></p>
                                <div class="sortlist" style="display:none"> </div>
                                <div id="orderdiv" style="display:none"><button type="button" tal:attributes="onclick python:u'saveOrder({})'.format(node.id)"
                                    i18n:translate="edit_files_order_save">TEXT</button></div>
                            </div>
                </div>
            </tal:block>

        </div>
        <!-- content -->
    </div>

    <div id="sub_footer_module"> </div>
</tal:block>

<tal:block metal:define-macro="edit_files_children_list">
    <div class="mediatum_edit_files_children_list" tal:repeat="child children">
        <a tal:attributes="href python:u'/edit/edit_content?srcnodeid={}&id={}&tab={}'.format(srcnodeid, child.id, child.get_default_edit_tab())">
            <img tal:attributes="src python:u'/thumbnail/{}'.format(child.id)"/></a>
        <div class="mediatum_edit_files_children_list_div">
            <a tal:attributes="href python:u'/edit/edit_content?srcnodeid={}&id={}&tab=metadata'.format(srcnodeid, child.id)">
                <img src="/static/img/edit.png"/>
            </a>
            <a href="#" tal:attributes="onclick python:u'return removeItem(this.id, {})'.format(node.id);id python:child.id">
                <img src="/static/img/delete.png"/>
            </a>
        </div>
    </div>
</tal:block>

<tal:block metal:define-macro="edit_files_popup_children" tal:condition="python:len(children)>0">
    <tal:block tal:repeat="child children">
    <div class="mediatum_edit_files_popup_children" tal:condition="python:child not in grandchildren and not child.isContainer()">
        <div class="mediatum_edit_files_popup_children_id" tal:content="python:child.id"></div>
        <div class="mediatum_edit_files_popup_children_child">
            <input class="mediatum_edit_files_popup_children_input" tal:attributes="value python:child.id" name="items_add" id="child_add" type="checkbox"/>
        </div>
        <img tal:attributes="src python:'/thumbnail/{}'.format(child.id)"/>
    </div>
    </tal:block>
</tal:block>

<tal:block metal:define-macro="edit_files_popup_grandchildren" tal:condition="python:len(grandchildren)>0">
    <tal:block tal:repeat="grand grandchildren">
    <div id="grandchildnode" tal:condition="python:grand in grandchildren" class="mediatum_edit_files_popup_children">
        <div class="mediatum_edit_files_popup_children_id" tal:content="python:grand.id"></div>
        <img tal:attributes="src python:'/thumbnail/{}'.format(grand.id)"/>
        <div class="mediatum_edit_files_popup_children_child">
            <input class="mediatum_edit_files_popup_children_input" tal:attributes="value python:grand.id" name="items_add" id="grands_add" type="checkbox"/>
        </div>
    </div>
    </tal:block>
</tal:block>

<tal:block metal:define-macro="edit_files_popup_selection">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta content="text/html;charset=UTF-8" http-equiv="content-type"/>
        <link rel="stylesheet" href="/static/css/editor.css" />
        <link rel="stylesheet" href="/static/css/ftree.css" type="text/css" />
        <link rel="stylesheet" tal:repeat="src html_head_style_src" tal:attributes="href src" />

        <script src="/static/js/ftree.js"> </script>
        <script src="/static/js/jquery-2.0.3.js"> </script>
        <script src="/static/js/mediatum.js"> </script>
        <script tal:repeat="src html_head_javascript_src" tal:attributes="src src"> </script>
    </head>
    <body>
        <script type="text/javascript" tal:content="script"> </script>
        <script src="/static/js/edit/modules/files2.js" > </script>
        <form>
            <h1 i18n:translate="edit_files_choosedirectory">TEXT</h1>
            <div class="mediatum_edit_files_choosedirectory">
                <ul id="tree" class="tree">
                    <li tal:repeat="basedir basedirs" tal:attributes="id python:'Node{}'.format(basedir.id)"><a tal:attributes="id python:str(basedir.id); title python: '{} ({})'.format(basedir.getLabel(), str(basedir.id))" tal:content="python:basedir.getLabel()" href="#">TEXT</a>
                        <ul>
                            <li tal:attributes="parentId python:basedir.id" class="spinner.gif">
                                <a href="#!" id="node_0" class="mediatum-link-mediatum"> </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <h1 i18n:translate="edit_files_nodes_colon">TEXT</h1>
            <input class="mediatum_float_left" id="select-all-child" type="checkbox" onclick="select_all_child(this)" tal:attributes="value python:True"/>
            <p i18n:translate="edit_files_select_all_child">TEXT</p>
            <div class="mediatum_edit_files_border" id="files">
            </div>

            <h1 i18n:translate="edit_files_children_colon">TEXT</h1>
            <input class="mediatum_float_left" id="select-all-grand" type="checkbox" onclick="select_all_grand(this)" tal:attributes="value python:True"/>
            <p i18n:translate="edit_files_select_all_grand">TEXT</p>
            <div class="mediatum_edit_files_border" id="grandchildren">
            </div>
            <p class="mediatum_files_ta_center">
                <button
                    class="mediatum_edit_files_ok"
                    type="button"
                    tal:attributes="onclick python:'selectedItems({})'.format(srcnodeid)"
                    i18n:translate="ok">
                </button>
                <button class="mediatum_edit_files_cancel" type="button" onclick="self.close()" i18n:translate="">
                    cancel
                </button>
            </p>
        </form>
       <script type="text/javascript">
            initTree({'idOfFolderTrees': ['tree'], 'multiselect':false});
        </script>
        <script>
            getFolderItemsExclude(currentfolder, currentitem);
            getGrandchildren(currentfolder);
        </script>
    </body>
</html>
</tal:block>
