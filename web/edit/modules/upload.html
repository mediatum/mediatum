<!--
  Copyright (C) since 2007, Technical University of Munich (TUM) and mediaTUM authors
  SPDX-License-Identifier: AGPL-3.0-or-later
-->
<tal:block metal:define-macro="upload_form">
    <script type="text/javascript" src="/js/plupload/plupload.full.min.js"> </script>
    <script type="text/javascript" src="/js/jquery.ui.plupload/jquery.ui.plupload.js"> </script>
    <!-- activate translation for plupload -->
    <script type="text/javascript" tal:attributes="src python:u'/js/plupload/i18n/{}.js'.format(language)"> </script>

    <link rel="stylesheet" href="/css/jquery-ui-1.12.1.css" type="text/css" />
    <link rel="stylesheet" href="/js/jquery.ui.plupload/css/jquery.ui.plupload.css" type="text/css" />
    <link rel="stylesheet" href="/css/uploadform.css" type="text/css" />

    <script tal:content="python:u'var id = \'{}\';'.format(id)"> </script>
    <script tal:content="python:u'var uploadstate = \'{}\';'.format(uploadstate)"/>
    <script tal:content="python:u'var js_upload_unpack = \'{}\';'.format(t(language, 'edit_upload_unpack'))"/>
    <script tal:content="python:u'var js_upload_no_unpack = \'{}\';'.format(t(language, 'edit_upload_no_unpack'))"/>
    <script tal:content="python:u'var csrf = \'{}\';'.format(csrf)"/>
    <script tal:content="python:u'var js_edit_layout_togglertip_open = \'{}\';'.format(t(language, 'edit_layout_togglertip_open'))"/>
    <script tal:content="python:u'var js_edit_layout_togglertip_closed = \'{}\';'.format(t(language, 'edit_layout_togglertip_closed'))"/>
    <script tal:content="python:u'var north_size = {};'.format(navigation_height + 30)"/>

    <div id="navigation_content">
        <tal:block tal:condition="python:len(schemes)>=1 and len(datatypes)>=1">
        <div class="mediatum_upload">
            <a class="mediatum_img_uploadmeta" href="#" onclick="openMetaForm()">
            <tal:block i18n:translate="edit_upload_meta"/></a>
        </div>
        </tal:block>

        <div class="mediatum_upload">
            <a class="mediatum_img_uploaddoi" href="#" onclick="openDoiForm()">
            <tal:block i18n:translate="edit_upload_doi"/></a>
        </div>

        <div class="mediatum_upload">
            <a class="mediatum_img_uploadfile" id="id_a_openplupload_file" href="#" onclick="openUploadFormPluploadWidgetFile()">
            <tal:block i18n:translate="edit_upload_files_plupload_widget"/></a>
        </div>

        <div class="mediatum_upload">
            <a class="mediatum_img_uploadbibtex" id="id_a_openplupload_bibtex" href="#" onclick="openUploadFormPluploadWidgetBib()">
            <tal:block i18n:translate="edit_upload_bibtex_plupload_widget"/></a>
        </div>

        <div id="search" tal:content="raw search"/>
    </div>

    <div class="mediatum_clear_right"> </div>
    <div id="sub_footer_module">
        <div class="mediatum_nav_bottom" tal:content="raw nav">TEXT</div>
        <div id="mediatum_sub_footer_module_div">
            <tal:block tal:replace="count"/> item(s)
        </div>
    </div>

    <div id="sub_content_content">
            <div class="mediatum_nav_top" tal:content="raw nav">TEXT</div>
        <div id="nodelist" tal:content="raw nodelist">TEXT</div>
    </div>

    <div id="mediatum_uploadform_plupload_widget_file">
        <div class="mediatum_pluploadform-background">&nbsp;</div>
        <div id="uploadform-form">
            <div class="mediatum_uploadform_widget">
                <a href="#" onclick="closeFormPluploadWidgetFile();" i18n:attributes="title mask_editor_cancel">
                <img src="/img/cancel.png"/></a>
            </div>
            <form tal:condition="python:len(schemes)!=0" class="mediatum_uploadform_style">
                <div id="uploaderfile">
                    <p>Your browser doesn't have Flash, Silverlight or HTML5 support.</p>
                </div>
                <br />
                <button id="id_button_createobjectsplupload_file" type="button" disabled onclick="createObjectsPluploadFile();" i18n:translate="edit_upload_create_objects"/>
                <span id="span_plupload_createobjects_file" > </span>
            </form>
            <form tal:condition="python:len(schemes)==0" class="mediatum_uploadform_style">
                <div>
                    <p>you cannot upload because you have no metadata types defined</p>
                </div>
                <br />
            </form>
        </div>
    </div>

    <div id="mediatum_uploadform_plupload_widget_bib">
        <div class="mediatum_pluploadform-background">&nbsp;</div>
        <div id="uploadform-form">
            <div class="mediatum_uploadform_widget">
                <a href="#" onclick="closeFormPluploadWidgetBib();" i18n:attributes="title mask_editor_cancel">
                <img src="/img/cancel.png"/></a>
            </div>
            <form tal:condition="python:len(schemes)!=0" class="mediatum_uploadform_style">
                <div id="uploaderbib">
                    <p>Your browser doesn't have Flash, Silverlight or HTML5 support.</p>
                </div>
                <br />
                <button id="id_button_createobjectsplupload_bib" type="button" disabled onclick="createObjectsPluploadBib();" i18n:translate="edit_upload_create_objects"> </button>
                <span id="span_plupload_createobjects_bib" > </span>
            </form>
            <form tal:condition="python:len(schemes)==0" class="mediatum_uploadform_style">
                <div>
                    <p>you cannot upload because you have no metadata types defined</p>
                </div>
                <br />
            </form>
        </div>
    </div>

    <div id="metaform">
        <div id="metaform-background">&nbsp;</div>
        <div id="metaform-form">
            <div class="mediatum_metaform_div">
                <a href="#" onclick="closeMetaForm()" i18n:attributes="title mask_editor_cancel">
                    <img src="/img/cancel.png"/>
                </a>
            </div>
            <form id="metaformcontent"> </form>
        </div>
    </div>

    <script src="/js/edit/modules/upload1.js"> </script>

</tal:block>

<tal:block metal:define-macro="addmeta">
    <script src="/js/edit/modules/upload3.js"> </script>
    <h3 i18n:translate="edit_upload_create_meta">TEXT</h3>

    <!-- create object via metadata scheme -->
    <div id="subform_meta">
      <p><tal:block i18n:translate="edit_upload_scheme"/><br/>
          <select name="schema" id="schema" onchange="showOrHide('#buttoncreate2', this.selectedIndex);">
              <option i18n:translate="edit_upload_schemeselection">TEXT</option>
              <tal:block tal:repeat="scheme schemes">
                  <option tal:attributes="value python:scheme['id']+'|'+scheme['datatype']; title python:scheme['description']"
                  tal:content="python:scheme['name']"/>
              </tal:block>
          </select>
      </p>
      <p class="mediatum_edit_upload_scheme_text">
          <button type="button" id="buttoncreate2" onclick="createMetaObject()" i18n:translate="edit_upload_create_object">TEXT</button>
      </p>
    </div>
</tal:block>

<tal:block metal:define-macro="adddoi">
    <script src="/js/edit/modules/upload2.js"> </script>
    <h3 i18n:translate="edit_upload_create_doi">TEXT</h3>

    <!-- create object from identifier (doi, ...) -->
    <div class="mediatum_subform_identifier">
      <div tal:condition="python:len(identifier_importers)>1">
          <tal:block i18n:translate="edit_upload_importer_sel"/><br/>
          <select name="identifier_importer" id="identifier_importer" onchange="disenableInput(this.selectedIndex)">
              <option value="-1" i18n:translate="edit_upload_importerselection">TEXT</option>
              <tal:block tal:repeat="identifier_importer identifier_importers">
                  <option i18n:translate="" tal:attributes="value python:identifier_importer.name"
                  tal:content="python:identifier_importer.get('labels', {}).get(language, {}).get('identifier_importer_longname', 'identifier_importer_longname')"/>
              </tal:block>
          </select>
          <div id="identifier_subform">
          <p tal:content="structure python:identifier_importers[0].get('labels', {}).get(language, {}).get('identifier_importer_explain', 'identifier_importer_explain')">TEXT</p>
          <div class="label"><tal:block i18n:translate="edit_upload_or_doi">TEXT</tal:block>:</div>
          <input id="input_identifier" type="text" name="input_identifier" disabled/>
          <p class="mediatum_subform_identifier_text">
              <button type="button" class="mediatum_buttoncreate3" onclick="createObjectFromIdentifier()" i18n:translate="edit_upload_create_object_doi">TEXT</button>
          </p>
          </div>
      </div>

      <div tal:condition="python:len(identifier_importers)==1">
          <p tal:content="structure python:identifier_importers[0].get('labels', {}).get(language, {}).get('identifier_importer_explain', 'identifier_importer_explain')">TEXT</p>
          <input type="hidden" name="identifier_importer" id="identifier_importer" tal:attributes="value python:identifier_importers[0].name"/>
          <input id="input_identifier" type="text" name="input_identifier" />
          <input id="dummy" type="text" name="" disabled/>
          <p class="mediatum_subform_identifier_text">
              <button type="button" class="mediatum_buttoncreate3" onclick="createObjectFromIdentifier()" i18n:translate="edit_upload_create_object_doi">TEXT</button>
          </p>
      </div>

    </div>

</tal:block>

<tal:block metal:define-macro="uploadfileok_plupload">
    <div class="schema" tal:define="type python:schemes.keys()[0]"> <span i18n:translate="edit_upload_select_metadata_type">Select metadata type: </span>
        <select class="typesel" tal:attributes="name python:u'scheme_{}'.format(filename); id type" tal:condition="python:len(schemes[type])>1">
            <tal:block tal:repeat="scheme python:schemes[type]">
                <option tal:attributes="value python:scheme.name" tal:content="python:scheme.getLongName()">TEXT</option>
            </tal:block>
        </select>
        <tal:block tal:condition="python:len(schemes[type])==1" tal:replace="python:schemes[type][0].getLongName()"/>
        <input type="hidden" tal:condition="python:len(schemes[type])==1" name="scheme" class="typesel" tal:attributes="id type; value python:schemes[type][0].name"/>
        <input type="hidden" tal:attributes="value python:'|'.join(files);id type"/>
    </div>
    <div tal:attributes="id python:u'err_{}'.format(hash(filename))"></div>
</tal:block>

<tal:block metal:define-macro="uploadzipfileok_plupload">
    <div class="schema" style="overflow:hidden;z-index:0">
        <div class="selection mediatum_uploadzipfileok_plupload">
        <tal:block tal:repeat="type python:schemes.keys()">
            <tal:block tal:content="type"/>
            <select name="scheme" class="typesel" tal:attributes="id type" tal:condition="python:len(schemes[type])>1">
                <tal:block tal:repeat="scheme python:schemes[type]">
                    <option tal:attributes="value python:scheme.name" tal:content="python:scheme.getLongName()">TEXT</option>
                </tal:block>
            </select>
            <tal:block tal:condition="python:len(schemes[type])==1" tal:replace="python:schemes[type][0].getLongName()"/>
            <input type="hidden" tal:condition="python:len(schemes[type])==1" class="typesel" name="scheme"
            tal:attributes="id type; value python:schemes[type][0].name"/>
            <br/>
            <input type="hidden" tal:attributes="value python:'|'.join(files);id type"/>
        </tal:block>
        </div>
        <div class="mediatum_uploadzipfileok">
            <tal:block tal:repeat="file files">
                <tal:block tal:content="file">TEXT</tal:block><br/>
            </tal:block>
        </div>
    </div>
</tal:block>

<tal:block metal:define-macro="uploadbibfileok_plupload">
    <div class="schema error" tal:condition="python:error!=''" i18n:translate="" tal:content="python:u'upload_{}'.format(error)">TEXT</div>
    <tal:block tal:condition="python:error==''">
        <div i18n:translate="edit_upload_bibtex_ok">TEXT</div>
        <input type="hidden" class="typesel" name="scheme" id="bibtex" value="bibtex"/>
        <input type="hidden" id="bibtex" tal:attributes="value python:'|'.join(files)"/>
    </tal:block>
</tal:block>

<tal:block metal:define-macro="uploadfileok">
    <div class="mediatum_uploadmsg">
        <a href="#" onclick="return removeItem(this)"><img src="/img/delete.png" /></a>
    </div>
    <div class="schema" tal:define="type python:schemes.keys()[0]">
        <select name="scheme" class="typesel" tal:attributes="id type" tal:condition="python:len(schemes[type])>1">
            <tal:block tal:repeat="scheme python:schemes[type]">
                <option tal:attributes="value python:scheme.name" tal:content="python:scheme.name">TEXT</option>
            </tal:block>
        </select>
        <tal:block tal:condition="python:len(schemes[type])==1" tal:replace="python:schemes[type][0].getLongName()"/>
        <input type="hidden" tal:condition="python:len(schemes[type])==1" name="scheme" class="typesel" tal:attributes="id type; value python:schemes[type][0].name"/>
        <input type="hidden" tal:attributes="value python:'|'.join(files);id type"/>
    </div>
</tal:block>

<tal:block metal:define-macro="uploadzipfileok">
    <div class="mediatum_uploadmsg">
        <a href="#" onclick="return removeItem(this)"><img src="/img/delete.png" /></a>
    </div>
    <div class="schema" style="overflow:hidden;z-index:0">
        <div class="selection" style="background-color:white;z-index:3">
        <tal:block tal:repeat="type python:schemes.keys()">
            <tal:block tal:content="type"/>
            <select name="scheme" class="typesel" tal:attributes="id type" tal:condition="python:len(schemes[type])>1">
                <tal:block tal:repeat="scheme python:schemes[type]">
                    <option tal:attributes="value python:scheme.name" tal:content="python:scheme.name">TEXT</option>
                </tal:block>
            </select>
            <tal:block tal:condition="python:len(schemes[type])==1" tal:replace="python:schemes[type][0].getLongName()"/>
            <input type="hidden" tal:condition="python:len(schemes[type])==1" class="typesel" name="scheme" tal:attributes="id type; value python:schemes[type][0].name"/>
            <br/>
            <input type="hidden" tal:attributes="value python:'|'.join(files);id type"/>
        </tal:block>
        </div>
        <div class="mediatum_uploadzipfileok">
            <tal:block tal:repeat="file files">
                <tal:block tal:content="file">TEXT</tal:block><br/>
            </tal:block>
        </div>
    </div>
</tal:block>

<tal:block metal:define-macro="uploadbibfileok">
    <div class="mediatum_uploadmsg">
        <a href="#" onclick="return removeItem(this)"><img src="/img/delete.png" /></a>
    </div>
    <div class="schema error" tal:condition="python:error!=''" i18n:translate="" tal:content="python:u'upload_{}'.format(error)">TEXT</div>
    <tal:block tal:condition="python:error==''">
        <div i18n:translate="edit_upload_bibtex_ok">TEXT</div>
        <input type="hidden" class="typesel" name="scheme" id="bibtex" value="bibtex"/>
        <input type="hidden" id="bibtex" tal:attributes="value python:'|'.join(files)"/>
    </tal:block>
</tal:block>

<tal:block metal:define-macro="uploadfileerror">
    <div class="mediatum_uploadmsg">
        <a href="#" onclick="return removeItem(this)"><img src="/img/delete.png" /></a>
    </div>
    <div class="schema error">Dateityp wird nicht unterst√ºtzt oder Sie besitzen keine Berechtigung.</div>
</tal:block>
